---
layout: post
title:  Webpackå­¦ä¹ è®°å½•ï¼ˆä¸åŒç±»å‹æ¨¡å—çš„æ‰“åŒ…ï¼‰
subtitle: å­¦ä¹ Webpackæ˜¯å¦‚ä½•å¯¹ä¸åŒç±»å‹çš„èµ„æºæ–‡ä»¶è¿›è¡Œæ‰“åŒ…
date: 2021-07-25
tags:
 - BUG
catalog: true
header_img: /images/header-bg/21-7-25-1.gif
header_style: image
---

# ğŸ² Webpackå­¦ä¹ è®°å½•ï¼ˆä¸åŒç±»å‹æ¨¡å—çš„æ‰“åŒ…ï¼‰

ä¸Šç¯‡æ–‡ç« ä¸»è¦äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯webpackï¼Œä»¥åŠwebpackçš„æ ¸å¿ƒæ¦‚å¿µï¼Œå¹¶å¯¹å…¶åŸºæœ¬é…ç½®ä¹Ÿæœ‰äº†ä¸€å®šçš„äº†è§£ã€‚è¯¥ç¯‡æ–‡ç« ä¸»è¦æ€»ç»“äº†webpacké’ˆå¯¹ä¸åŒç±»å‹æ¨¡å—çš„æ‰“åŒ…ã€‚

åœ¨webpackä¸­ï¼Œwebpackæœ¬èº«åšçš„äº‹æƒ…ä»…ä»…åªæ˜¯åˆ†æå‡ºå„ä¸ªæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç„¶åå½¢æˆèµ„æºåˆ—è¡¨ï¼Œæœ€åæ‰“åŒ…åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ã€‚åœ¨webpackçœ‹æ¥ï¼Œä»»ä½•çš„æ–‡ä»¶éƒ½æ˜¯æ¨¡å—ï¼Œä½†æ˜¯webpackåªæ”¯æŒå¯¹jså’Œjsonæ–‡ä»¶æ‰“åŒ…ã€‚åƒæ˜¯cssã€sassã€pngç­‰è¿™äº›ç±»å‹çš„æ–‡ä»¶ï¼Œwebpackéœ€è¦å€ŸåŠ©å¯¹åº”çš„loaderå¯¹å…¶è¿›è¡Œè§£æï¼ŒåŒæ—¶pluginæ’ä»¶ä¹Ÿå¯ä»¥ä¸ºloaderå¸¦æ¥æ›´å¤šçš„ç‰¹æ€§ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹webpackæ˜¯å¦‚ä½•å¯¹å„ç±»æ¨¡å—è¿›è¡Œæ‰“åŒ…çš„æŠŠ~ğŸ‘‡

<img src="https://i.loli.net/2021/10/14/lHnsJfyrjOeRqZp.png" alt="webpackæ‰“åŒ…" style="zoom: 50%;" />



## ä¸€ã€æ‰“åŒ…CSS

---

### 1. Webpackæ‰“åŒ…CSS

webpacké»˜è®¤åªä¼šå¤„ç†JSæ–‡ä»¶ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨ç›¸åº”çš„loaderæ¥å¤„ç†CSSæ–‡ä»¶ï¼Œè¿™é‡Œæ‰“åŒ…CSSéœ€è¦å€ŸåŠ©ä¸¤ä¸ªloaderåˆ†åˆ«æ˜¯ï¼š

- css-loaderï¼šå°†CSSæ–‡ä»¶è½¬æ¢æˆä¸€ä¸ªJSæ¨¡å—ï¼ˆå°†CSSè¾“å‡ºåˆ°æ‰“åŒ…åçš„JSæ–‡ä»¶ä¸­ï¼‰
- style-loaderï¼šæŠŠåŒ…å«CSSå†…å®¹çš„JSä»£ç ï¼ŒæŒ‚è½½åˆ°é¡µé¢çš„styleæ ‡ç­¾ä¸­

#### å®‰è£…

```bash
npm i css-loader styly-loader -D
```

#### é…ç½®

```javascript
// webpack.config.js
module.exports = {
  ...
  entry: './src/main.js', 
  ...
  module: {
    rules: [
      {
        test: /.css$/, // åŒ¹é…ä»¥cssç»“å°¾çš„æ–‡ä»¶
        use: [
          'style-loader',  // å°†JSä¸­çš„æ ·å¼ï¼ŒæŒ‚è½½åˆ°styleæ ‡ç­¾ä¸­ 
          'css-loader'  // css-loaderæŒ‰ç…§Common JSè§„èŒƒï¼Œè®²æ ·å¼æ–‡ä»¶è¾“å‡ºåˆ°JSä¸­
        ]
      }
    ]
  }
}
```

> æ³¨æ„ï¼šloaderçš„æ‰§è¡Œé¡ºåºæ˜¯å…ˆä¸‹åä¸Šï¼Œå°±æ˜¯useæ•°ç»„ä¼šé€†åºæ‰§è¡Œloaderä»¬



### 2. Webpackæ‰“åŒ…less

å¤„ç†lessæ–‡ä»¶æ—¶ï¼Œéœ€è¦å…ˆå€ŸåŠ©less-loaderå°†lessè½¬æ¢æˆcssï¼Œscssç­‰é¢„ç¼–è¯‘è¯­è¨€ä¹Ÿæ˜¯ä¸€æ ·çš„é€»è¾‘

```bash
npm i less less-loader -D
```

```javascript
module:{
  rules:[            
    {                
      test: /\.less$/,                
      use:[                    
        'style-loader',                 
        'css-loader',      
        'less-loader',  // å°†lesså…ˆè½¬æ¢æˆcss
      ]            
    }        
  ]    
}
```

> è¿™é‡Œéœ€è¦æ³¨æ„åœ¨useä¸­æ’å…¥loaderçš„é¡ºåºï¼Œå¿…é¡»å…ˆè®©less-loaderæ‰§è¡Œï¼Œå°†å…¶è§£ææˆcssåå†è¿›è¡Œåç»­çš„æ“ä½œ

<img src="C:\Users\éƒè‰ºç’‡\AppData\Roaming\Typora\typora-user-images\image-20211014225418343.png" alt="image-20211014225418343" style="zoom: 50%;" /> 



### 3. å°†CSSæ‰“åŒ…æˆç‹¬ç«‹çš„æ–‡ä»¶

å½“å¤„ç†å®Œcsså’Œlessæ—¶ï¼Œä¸å¸Œæœ›æ ·å¼é€šè¿‡styleçš„æ–¹å¼å¼•å…¥åˆ°htmlæ–‡ä»¶ä¸­ï¼Œè€Œæ˜¯å¸Œæœ›å…¶æŠ½ç¦»æˆä¸€ä¸ªå•ç‹¬çš„æ ·å¼æ–‡ä»¶ã€‚è¿™æ—¶éœ€è¦å€ŸåŠ©`mini-css-extract-plugin`æ’ä»¶æ¥å®Œæˆï¼Œè¯¥æ’ä»¶å¯ä»¥æ›¿æ¢`style-loader`

```bash
npm i mini-css-extract-plugin -D
```

```javascript
// webpack.consig.js
const MiniCssExtractPlugin = require('mini-css-extract-plugin')
module:{
  rules:[            
    {              
      test: /\.css$/,                
      use:[                    
        MiniCssExtractPlugin.loader, //æ›¿æ¢style-loader,å°†cssæ‰“åŒ…æˆç‹¬ç«‹çš„æ–‡ä»¶    
        'css-loader'      // åŠ è½½å¤„ç†cssæ–‡ä»¶    
      ]           
    }        
  ]    
},
plugins:[
  // å®ä¾‹åŒ–æ’ä»¶
  new MiniCssExtractPlugin({
     filename:'index.css'  //é‡å‘½åè¾“å‡ºçš„cssæ–‡ä»¶ï¼Œä¹Ÿå¯ä¸å†™é»˜è®¤
  })
]
```



### 4. å¤„ç†CSSå…¼å®¹æ€§é—®é¢˜

CSSåœ¨ä¸åŒæµè§ˆå™¨ä¸Šçš„å…¼å®¹æ€§ä¸ä¸€è‡´ï¼Œå¯¹äºä¸€äº›æ¯”è¾ƒæ–°çš„CSSå±æ€§éœ€è¦é’ˆå¯¹ä¸åŒçš„æµè§ˆå™¨æ·»åŠ ç›¸åº”çš„æ ·å¼å‰ç¼€ã€‚åœ¨webpackä¸­å¯ä»¥ä½¿ç”¨`postcss-loader`ä¸­çš„`autoprefixer`æ’ä»¶æ¥å¸®åŠ©æˆ‘ä»¬å®Œæˆè¿™ä¸ªå·¥ä½œã€‚

ã€æ‰©å±•ã€‘ä»€ä¹ˆæ˜¯PostCSSï¼š

- PostCSSæ˜¯ä¸€ä¸ªé€šè¿‡JavaScriptæ¥è½¬æ¢æ ·å¼çš„å·¥å…·
- è¿™ä¸ªå·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œä¸€äº›CSSçš„è½¬æ¢å’Œé€‚é…ï¼Œæ¯”å¦‚è‡ªåŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€ã€cssæ ·å¼çš„é‡ç½®

```bash
npm i postcss-loader autoprefixer -D
```

ä¹‹åå¯ä»¥åœ¨`webpack.config.js`æ–‡ä»¶ä¸­å¼•å…¥postcss-loader

```javascript
module:{
  rules:[            
    {              
      test: /\.css$/,                
      use:[                    
        // ç¬¬3æ­¥ï¼šå°†cssæ‰“åŒ…æˆç‹¬ç«‹çš„æ–‡ä»¶
        MiniCssExtractPlugin.loader,
        // ç¬¬2æ­¥ï¼šå°†cssè¾“å‡ºåˆ°æ‰“åŒ…åçš„jsä¸­
        'css-loader',
        // ç¬¬1æ­¥ï¼šé€šè¿‡postcss-loaderç»™æ ·å¼å±æ€§æ·»åŠ æµè§ˆå™¨å‰ç¼€
        'postcss-loader',
      ]         
    }        
  ]    
},
```

å› ä¸ºæˆ‘ä»¬åªæ˜¯æƒ³è¦ä½¿ç”¨`postcss-loader`ä¸­çš„`autoprefixer`æ’ä»¶æ¥å¸®åŠ©æˆ‘ä»¬æ·»åŠ æµè§ˆå™¨å‰ç¼€ï¼Œæ‰€ä»¥å¯ä»¥æ–°å»ºä¸€ä¸ª`postcss.config.js`æ–‡ä»¶æ¥å¼•å…¥è¿™ä¸ªæ’ä»¶ï¼ˆåŸºäºCommon.jsè§„èŒƒï¼‰

```javascript
module.exports = {
  plugins: [
    require('autoprefixer')
  ]
}
```

å¯¹äºä¸Šè¿°çš„é…ç½®å¯ä»¥æŒ‡å®šéœ€è¦å…¼å®¹çš„æµè§ˆå™¨ï¼Œå¯ä»¥ç›´æ¥åœ¨package.jsonæ–‡ä»¶ä¸­ç›´æ¥æŒ‡å®šbrowserslistï¼Œä¹Ÿå¯ä»¥åœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª.browserslistrcæ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ç›´æ¥åœ¨package.jsonæ–‡ä»¶ä¸­æŒ‡å®šäº†

```json
"browserslist": [
  "last 1 version",  // åŒ¹é…åˆ°æµè§ˆå™¨çš„æœ€åä¸€ä¸ªç‰ˆæœ¬
  "> 1%"  // ä»£è¡¨å…¨çƒè¶…è¿‡1%ä½¿ç”¨çš„æµè§ˆå™¨
]
```



æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªæ’ä»¶`postcss-preset-env`æ¥å¸®åŠ©æˆ‘ä»¬å®Œæˆä¸Šé¢çš„å·¥ä½œï¼Œä¸éœ€è¦å€ŸåŠ©autoprefixer

`postcss-preset-env`: å¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†ä¸€äº›ç°ä»£çš„CSSç‰¹æ€§ï¼Œè½¬æˆå¤§å¤šæ•°æµè§ˆå™¨è®¤è¯†çš„CSSï¼Œå¹¶ä¸”ä¼šæ ¹æ®ç›®æ ‡æµè§ˆå™¨æˆ–è€…è¿è¡Œæ—¶ç¯å¢ƒæ·»åŠ æ‰€éœ€çš„polyfillï¼› ä¹ŸåŒ…æ‹¬ä¼šè‡ªåŠ¨å¸®åŠ©æˆ‘ä»¬æ·»åŠ autoprefixerï¼ˆæ‰€ä»¥ç›¸å½“äºå·²ç»å†…ç½®äº†autoprefixerï¼‰,æ¯”autoprefixeræ’ä»¶çš„åŠŸèƒ½æ›´åŠ çš„å¼ºå¤§ã€‚

```bash
npm i postcss-preset-env -D
```



### 5. æ ¡éªŒCSSä»£ç æ ¼å¼

åœ¨webpackä¸­å¯¹CSSä»£ç è¿›è¡Œæ ¼å¼æ ¡éªŒçš„æ—¶å€™ï¼Œå¯ä»¥å¼•å…¥ä¸‰ä¸ªåŒ…æ¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ ¡éªŒ

- `stylelint`ï¼šå¯¹CSSä»£ç æ ¼å¼è¿›è¡Œæ ¡éªŒğŸ‘‰ https://stylelint.io/
- `stylelint-config-standard`ï¼šè¿›è¡ŒCSSä»£ç æ ¡éªŒçš„è§„åˆ™é›†ï¼ˆä¸€äº›å¤§å…¬å¸éµå¾ªçš„ä»£ç è§„èŒƒï¼‰ ğŸ‘‰ https://github.com/stylelint/stylelint-config-standard
- `stylelint-webpack-plugin`ï¼šå…è®¸åœ¨webpackä¸­ä½¿ç”¨stylelintå¯¹CSSä»£ç è¿›è¡Œæ ¼å¼æ ¡éªŒ

```bash
npm i stylelint stylelint-config-standard stylelint-webpack-plugin -D
```

åœ¨webpack.config.jsä¸­å¼•å…¥stylelint-webpack-pluginæ’ä»¶

```javascript
// å¼•å…¥æ ¡éªŒcssä»£ç æ ¼å¼çš„æ’ä»¶
const StylelintPlugin = require('stylelint-webpack-plugin')
module.exports = {
  // é…ç½®æ’ä»¶
  plugins: [
  	new StylelintPlugin({
      // æŒ‡å®šéœ€è¦è¿›è¡Œæ ¼å¼æ ¡éªŒçš„æ–‡ä»¶
      files: ['./src/css/*.{css, less, sass, scss}']
    })
  ]
}
```

åœ¨package.jsonæ–‡ä»¶ä¸­é…ç½®stylelint-config-standard

```json
"stylelint": {
   "extends": "stylelint-config-standard",
    // å¯ä»¥æŒ‡å®šruleså±æ€§æ¥å¯¹è§„åˆ™é›†è¿›è¡Œæ‰©å±•
    "rules": {}
 }
```

> æŒ‡å®šè§„åˆ™çš„é…ç½®æœ‰ä¸‰ç§æ–¹å¼ï¼ŒæŒ‰ç…§åŠ è½½çš„å…ˆåé¡ºåºï¼Œä¾æ¬¡æ˜¯ï¼š
>
> - åœ¨package.jsonä¸­çš„stylelintå±æ€§æŒ‡å®šè§„åˆ™
> - åœ¨.stylelintrcä¸­æŒ‡å®šè§„åˆ™
> - åœ¨stylelint.config.jsä¸­æŒ‡å®šè§„åˆ™



### 6. å‹ç¼©CSS

å½“æˆ‘ä»¬å¸Œæœ›å¯¹æ‰“åŒ…åçš„CSSè¿›è¡Œå‹ç¼©å¯ä»¥ä½¿ç”¨optimize-css-assets-webpack-plugin -Dæ’ä»¶

```bash
npm i optimize-css-assets-webpack-plugin -D
```

ä¹‹ååœ¨webpack.config.jsä¸­çš„ä¸­å¼•å…¥å¹¶ä¸”è¿›è¡Œåˆå§‹åŒ–åï¼Œæ‰“åŒ…å‡ºæ¥çš„CSSå°±æ˜¯å‹ç¼©ç‰ˆçš„å•¦

```javascript
// å¼•å…¥å‹ç¼©CSSçš„æ’ä»¶
const OptimizeCssAssetsPlugin = require('optimize-css-assets-webpack-plugin')
module.exports = {
  // é…ç½®æ’ä»¶
  plugins: [
  	new OptimizeCssAssetsPlugin()
  ]
}
```



## äºŒã€æ‰“åŒ…HTML

---

æ‰“åŒ…å®Œæˆåæˆ‘ä»¬ä¼šæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªhtmlæ–‡ä»¶å¼•å…¥æ‰“åŒ…åçš„èµ„æºæ¥æŸ¥çœ‹æ•ˆæœï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨`html-webpack-plugin`æ’ä»¶æ¥å¸®åŠ©æˆ‘ä»¬ç®€åŒ–HTMLæ–‡ä»¶çš„åˆ›å»ºï¼Œä»¥ä¾¿ä¸ºä½ çš„webpackåŒ…æä¾›æœåŠ¡ã€‚

`html-webpack-plugin`:

- è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªHTMLæ–‡ä»¶ï¼ˆç”¨äºæœåŠ¡å™¨è®¿é—®ï¼‰ï¼Œå¹¶åœ¨HTMLä¸­åŠ è½½æ‰€æœ‰çš„æ‰“åŒ…èµ„æº
- æŒ‡å®šHTMLæ¨¡æ¿ã€è®¾ç½®HTMLå˜é‡ã€å‹ç¼©HTML

```bash
npm i html-webpack-plugin -D
```

ä¸‹è½½ååœ¨webpack.config.jsä¸­å¼•ç”¨è¯¥æ’ä»¶ï¼Œåœ¨å®ä¾‹åŒ–æ’ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥æŒ‡å®šæ‰“åŒ…å‡ºæ¥çš„HTMLæ–‡ä»¶åç§°ã€æŒ‡å®šå¼•ç”¨çš„HTMLæ¨¡æ¿ä»¥åŠå®šä¹‰HTMLä¸­ä½¿ç”¨çš„å˜é‡ç­‰æ“ä½œ

```javascript
const HtmlWebpackConfig = require('html-webpack-plugin')
module.exports = {
  // é…ç½®æ’ä»¶
  plugins: [
  	// é…ç½®html
    new HtmlWebpackConfig({
      // æŒ‡å®šæ‰“åŒ…å‡ºæ¥çš„htmlæ–‡ä»¶åç§°
      filename: 'index.html',
      // æŒ‡å®šç”Ÿæˆçš„HTMLæ¨¡æ¿
      template: './src/index.html',
      // æŒ‡å®šHTMLä¸­ä½¿ç”¨çš„å˜é‡
      title: 'é¦–é¡µ'
  ]
}
```

è¯¦ç»†é…ç½®ğŸ‘‰ https://webpack.docschina.org/plugins/html-webpack-plugin/#configuration



## ä¸‰ã€æ‰“åŒ…JavaScript

---

### 1. Webpackç¼–è¯‘JS

è™½ç„¶webpackå¯ä»¥ç›´æ¥å¯¹JSè¿›è¡Œæ‰“åŒ…ï¼Œä½†æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨ä¸€äº›ES6+çš„æ–°ç‰¹æ€§æ—¶ï¼Œå¹¶ä¸èƒ½å¯¹å…¶è¿›è¡Œè½¬è¯‘ã€‚å¦‚æœéœ€è¦å°†ES6+è½¬æ¢æˆES5ï¼Œä»è€Œä¿è¯JSåœ¨ä½ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸Šä¹Ÿå¯ä»¥å…¼å®¹ã€‚è¿™æ—¶å¯ä»¥å€ŸåŠ©`babel-loader`æ¥å¸®åŠ©æˆ‘ä»¬å°†ES6+çš„è¯­æ³•è½¬æ¢æˆES5ã€‚ä¸ºäº†ä½¿å¯¹JSçš„è½¬è¯‘æ›´åŠ çš„çµæ´»ä¸å¼ºå¤§è¿˜å¯ä»¥å¼•å…¥`@babel/core`å’Œ`@babel/preset-env`

- `@babel/core`ï¼šåŒ…å«äº†ä¸€äº›JSè½¬è¯‘çš„æ ¸å¿ƒæ’ä»¶ï¼Œå…¶ä½œç”¨æ˜¯æ˜¯å°†JSä»£ç åˆ†ææˆastï¼Œæ–¹ä¾¿å„ä¸ªæ’ä»¶åˆ†æè¯­æ³•è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚

![image-20211015150744026](C:\Users\éƒè‰ºç’‡\AppData\Roaming\Typora\typora-user-images\image-20211015150744026.png)

- `@babel/preset-env`ï¼šä¸»è¦åŠŸèƒ½æœ‰ä¸¤ä¸ªï¼š(1) å°†å°šæœªè¢«å¤§éƒ¨åˆ†æµè§ˆå™¨æ”¯æ´çš„JavaScript è¯­æ³•è½¬æ¢æˆèƒ½è¢«æµè§ˆå™¨æ”¯æ´çš„è¯­æ³•ã€‚ (2) è®©è¾ƒæ—§çš„æµè§ˆå™¨ä¹Ÿèƒ½æ”¯æŒå¤§éƒ¨åˆ†æµè§ˆå™¨èƒ½æ”¯æŒçš„è¯­æ³•ğŸ‘‰ [è¯¦ç»†è®²è§£](https://www.jiangruitao.com/babel/babel-preset-env/)

```bash
npm i babel-loader @babel/core @babel/preset-env -D
```

[babel-loaderè¯¦ç»†ä½¿ç”¨](https://www.npmjs.com/package/babel-loader)

```javascript
module: {
  rules: [
    {
      test: /\.m?js$/,
      exclude: /node_modules/,
      use: {
        loader: 'babel-loader',
        options: {
          presets: [
            ['@babel/preset-env', { targets: "defaults" }]
          ]
        }
      }
    }
  ]
}
```

ç»è¿‡ä¸Šé¢çš„é…ç½®å·²ç»å¯ä»¥å¯¹ES6+çš„å¤§éƒ¨åˆ†è¯­æ³•è¿›è¡Œè½¬è¯‘äº†ï¼Œä½†æ˜¯`@babel/preset-env`åªèƒ½å¤Ÿè½¬è¯‘åŸºæœ¬çš„è¯­æ³•ï¼Œæ¯”å¦‚åƒæ˜¯promiseè¿™ä¸ªæ–°è¯­æ³•å°±æ²¡æœ‰åŠæ³•è¿›è¡Œè½¬è¯‘ã€‚è¿™æ—¶å¯ä»¥å€ŸåŠ©`@babel/polyfill`åŒ…ï¼Œè¿™ä¸ªåŒ…å¯ä»¥å¸®åŠ©æˆ‘ä»¬è½¬è¯‘æ‰€æœ‰çš„JSæ–°è¯­æ³•ï¼Œä½†æ˜¯ä¼šå¯¼è‡´æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶å¤§äº†è®¸å¤šï¼Œå¯ä»¥é…åˆ`core-js`(æŒ‰éœ€è½¬è¯‘æ–°è¯­æ³•)ä¸€èµ·ä½¿ç”¨

### 2. æ ¡éªŒJSçš„ä»£ç æ ¼å¼

JSå’ŒCSSä¸€æ ·ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¹Ÿéƒ½éœ€è¦è¿›è¡Œä»£ç æ ¼å¼çš„æ ¡éªŒã€‚ä¸€èˆ¬ä¼šå¼•å…¥ä¸‹é¢è¿™å‡ ä¸ªåŒ…å¯¹JSçš„ä»£ç æ ¼å¼è¿›è¡Œæ ¡éªŒ

- `eslint`ï¼šæ ¡éªŒJSä»£ç æ ¼å¼çš„å·¥å…·  ğŸ‘‰ https://eslint.org/
- `eslint-config-airbnb-base`ï¼šæœ€æµè¡Œçš„JSä»£ç æ ¼å¼è§„èŒƒ  ğŸ‘‰ https://www.npmjs.com/package/eslint-config-airbnb-base
- `eslint-webpack-plugin`ï¼šwebpackçš„eslintæ’ä»¶  ğŸ‘‰ https://webpack.docschina.org/plugins/eslint-webpack-plugin/#root
- `eslint-plugin-import`ï¼šç”¨äºåœ¨package.jsonä¸­è¯»å–

```bash
npm i eslint eslint-config-airbnb-base eslint-webpack-plugin eslint-plugin-import -D
```

åœ¨webpack.config.jsä¸­å¼•å…¥å¹¶å®ä¾‹åŒ–`eslint-webpack-plugin`

```javascript
// jsä»£ç æ ¼å¼æ ¡éªŒ
const ESlintPlugin = require('eslint-webpack-plugin')
module.expoers = {
    plugins: [
      // jsä»£ç æ ¼å¼æ ¡éªŒé…ç½®
      new ESlintPlugin({
        // è‡ªåŠ¨è§£å†³ä¸€äº›å¸¸è§„çš„ä»£ç æ ¼å¼é”™è¯¯
        fix: true
      })
  ]
}
```

JSä»£ç çš„æ ¡éªŒè§„åˆ™åŸºäºä¹‹å‰ä¸‹è½½çš„`eslint-config-airbnb-base`ï¼Œå¯ä»¥åœ¨package.jsonæ–‡ä»¶ä¸­å¯¹å…¶è¿›è¡Œæ‰©å±•

```json
"eslintConfig": {
  "extends": "airbnb-base"
}
```





## å››ã€æ‰“åŒ…å›¾ç‰‡èµ„æº

---

å¤§å¤šæ•°çš„èµ„æºåŠ è½½å™¨éƒ½ç±»ä¼¼css-loaderï¼Œéƒ½æ˜¯å°†èµ„æºæ¨¡å—è½¬åŒ–ä¸ºjsä»£ç çš„å®ç°æ–¹å¼å»å·¥ä½œã€‚ä½†æ˜¯è¿˜æœ‰ä¸€äº›æˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„èµ„æºæ–‡ä»¶ï¼Œä¾‹å¦‚é¡¹ç›®å½“ä¸­çš„å›¾ç‰‡ã€å­—ä½“ï¼Œè¿™äº›æ–‡ä»¶æ²¡æœ‰åŠæ³•é€šè¿‡jsçš„æ–¹å¼è¡¨ç¤ºã€‚å¯¹äºè¿™ä¸€ç±»çš„èµ„æºæ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°æ–‡ä»¶èµ„æºåŠ è½½å™¨ï¼Œä¹Ÿå°±æ˜¯file-loaderã€‚

1. `file-loader`ï¼šå…¶ä½œç”¨å°±æ˜¯å¸®åŠ©æˆ‘ä»¬å¤„ç†import/require()æ–¹å¼å¼•å…¥çš„ä¸€ä¸ªæ–‡ä»¶èµ„æºï¼Œå¹¶ä¸”ä¼šå°†å®ƒæ”¾åˆ°æˆ‘ä»¬è¾“å‡ºçš„æ–‡ä»¶å¤¹ä¸­ã€‚

```bash
npm i file-loader -D
```

é»˜è®¤æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶åç§°æ˜¯ä¸€ä¸ªéšæœºçš„å“ˆå¸Œå€¼ï¼Œæ¯”è¾ƒéš¾ä¸æˆ‘ä»¬åŸæœ¬çš„å›¾ç‰‡æ–‡ä»¶å¯¹åº”èµ·æ¥ã€‚å¯ä»¥åœ¨`file-laoder`çš„é…ç½®é¡¹ä¸­æŒ‡å®šæ‰“åŒ…åçš„å›¾ç‰‡åç§°ï¼Œä»¥åŠè®¾ç½®è¾“å‡ºçš„æ–‡ä»¶å¤¹

```javascript
// webpack.config.js
module: {
  rules: [
    {
      test: /\.(png|jpe?g|gif|svg)/,
      use: {
        loader: 'file-loader',
        options: {
          name: '[name].[hash:8].[ext]',  // [name]å›¾ç‰‡åŸæ¥çš„åç§° | [ext]å›¾ç‰‡åŸæ¥çš„åç¼€å
          outputPath: 'img'   // æ‰“åŒ…è¾“å‡ºçš„æ–‡ä»¶å¤¹
        }
      }
    }
  ]
}
```



é™¤äº†`file-loader`è¿˜å¯ä»¥ä½¿ç”¨`url-loader`æ¥å¸®åŠ©æˆ‘ä»¬æ‰“åŒ…å›¾ç‰‡ç±»å‹çš„èµ„æºã€‚

2. `url-loader`ï¼šç›¸å½“äº`file-loader`çš„å‡çº§ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šå›¾ç‰‡å¤§å°çš„é™åˆ¶ï¼Œå°äºè¯¥é™åˆ¶çš„å›¾ç‰‡ä¸ä¼šè¢«å•ç‹¬å•åŒ…ï¼Œè€Œæ˜¯è½¬æ¢æˆbase64å­—ç¬¦ä¸²æ‰“åŒ…åœ¨JSæ–‡ä»¶ä¸­ã€‚è¿™æ ·å›¾ç‰‡å°±ä¼šå’ŒJSæ–‡ä»¶ä¸€èµ·åŠ è½½ï¼Œå‡å°‘äº†å›¾ç‰‡çš„è¯·æ±‚æ¬¡æ•°

```bash
npm i url-loader -D
```

åœ¨webpackä¸­å¼•å…¥è¯¥loaderï¼Œå¹¶é…ç½®å…¶å›¾ç‰‡å¤§å°çš„é™åˆ¶

```javascript
module: {
  rules: [
    {
       test: /\.(png|gif|jpe?g)$/i,
       use: {
         loader: 'url-loader',
         options: {
           // æŒ‡å®šå›¾ç‰‡å¤§å°çš„é™åˆ¶ï¼Œå°äºè¯¥é™åˆ¶çš„å›¾ç‰‡ï¼Œä¼šè¢«ç¼–è¯‘æˆbase64æ ¼å¼
           limit: 10 * 1024,   // 10kb
           name: 'img/[name].[ext]',
         }
       }
     },
  ]
}
```

ã€é—®é¢˜ä¼˜åŒ–ã€‘æ¯æ¬¡å¼•å…¥å›¾ç‰‡çš„æ—¶å€™ï¼Œéœ€è¦åœ¨å…¥å£æ–‡ä»¶ä¸­ä»¥æ¨¡å—çš„æ–¹å¼å¼•å…¥ä¹‹åï¼Œå†æŒ‚è½½åˆ°domèŠ‚ç‚¹ä¸Šã€‚æœ‰æ²¡æœ‰ä»€ä¹ˆæ›´å¥½çš„æ–¹å¼è®©å›¾ç‰‡ç›´æ¥åœ¨htmlæ¨¡æ¿ä¸­ä»¥æ ‡ç­¾çš„æ¨¡å¼ç›´æ¥å¼•å…¥ï¼Œä¹‹åæ‰“åŒ…åä¹Ÿå¯ä»¥æœ‰æ­£ç¡®çš„è·¯å¾„æ˜¾ç¤ºå›¾ç‰‡

ã€é—®é¢˜è§£å†³ã€‘å¯ä»¥ä½¿ç”¨[html-loader](https://www.webpackjs.com/loaders/html-loader/)

3. `html-loader`ï¼šå°†HTMLå¯¼å‡ºæˆå­—ç¬¦ä¸²ï¼Œè´Ÿè´£å¼•å…¥imgï¼Œä»è€Œèƒ½è¢«url-loaderè¿›è¡Œå¤„ç†

```bash
npm i html-loader -D
```

```javascript
module: {
  rules: [
    {
       test: /\.(htm|html)$/i,
       use: {
         // html-loaderä¼šé‡‡ç”¨url-loaderåŠ è½½å›¾ç‰‡ï¼Œä½†æ˜¯url-loaderå’Œhtml-loaderä½¿ç”¨çš„é»˜è®¤åŠ è½½è§„èŒƒä¸ä¸€æ ·
         loader: 'html-loader',
         options: {
           // å¦‚æœwebapck4ï¼šåªéœ€è¦åœ¨url-loaderé…ç½®ä¸­é…ç½®esModuleä¸ºfalse
           // å¦‚æœwebpack5: åœ¨url-loaderå’Œhtml-loaderä¸­éƒ½éœ€è¦è¿›è¡Œé…ç½®
           esModule: false
         }
       }
     },
  ]
}
```



## äº”ã€èµ„æºæ¨¡å—ï¼ˆAsset Moduleï¼‰

---

åœ¨webpack5ä¹‹å‰ï¼ŒåŠ è½½èµ„æºæ–‡ä»¶ï¼ˆå­—ä½“ã€å›¾ç‰‡ã€å›¾æ ‡ã€HTML...ï¼‰éœ€è¦ä½¿ç”¨ä¸€äº›loaderï¼Œæ¯”å¦‚raw-loader ã€url-loaderã€file-loaderã€‚ åœ¨webpack5å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨èµ„æºæ¨¡å—ç±»å‹ï¼ˆ`asset module type`ï¼‰ï¼Œæ¥æ›¿ä»£ä¸Šé¢çš„è¿™äº›loaderï¼Œè€Œæ— éœ€é…ç½®é¢å¤–çš„loader

 èµ„æºæ¨¡å—ç±»å‹(asset module type)ï¼Œé€šè¿‡æ·»åŠ  4 ç§æ–°çš„æ¨¡å—ç±»å‹ï¼Œæ¥æ›¿æ¢æ‰€æœ‰è¿™äº› loader

- Webpack4ï¼š
  - raw-loaderï¼šå°†æ–‡ä»¶å¯¼å…¥ä¸ºå­—ç¬¦ä¸²
  - file-loaderï¼šå°†æ–‡ä»¶å‘é€åˆ°è¾“å‡ºç›®å½•
  - url-loaderï¼šå°†æ–‡ä»¶å‘é€åˆ°è¾“å‡ºç›®å½•ï¼Œæˆ–è½¬ä¸ºData URLå†…è”åˆ°bundleä¸­
- Webpack5ï¼š
  - asset/resourceï¼šå‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶å¹¶å¯¼å‡ºURL(ç›¸å½“äºä¹‹å‰çš„file-loader)
  - asset/inlineï¼šå¯¼å‡ºä¸€ä¸ªèµ„æºçš„data URL(ä¹‹å‰é€šè¿‡ä½¿ç”¨url-laoderå®ç°)
  - asset/sourceï¼šå¯¼å‡ºèµ„æºçš„æºä»£ç (ä¹‹å‰é€šè¿‡ä½¿ç”¨raw-loaderå®ç°)
  - assetï¼šå†å¯¼å‡ºä¸€ä¸ªdata URLå’Œå‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¹‹é—´è‡ªåŠ¨é€‰æ‹©(ä¹‹å‰é€šè¿‡ä½¿ç”¨ url-loaderï¼Œå¹¶ä¸”é…ç½®èµ„æºä½“ ç§¯é™åˆ¶å®ç°ï¼‰

ä¸¾ä¸ªğŸŒ°ï¼Œ ä»¥webpack4å’Œwebpack5åˆ†åˆ«å¤„ç†å­—ä½“èµ„æºæ–‡ä»¶ä¸¾ä¾‹

```javascript
// webpack4ä¸­å¤„ç†å­—ä½“èµ„æºæ–‡ä»¶
module: {
  rules: [
    {
       test: /\.(eot|svg|ttf|woff|woff2)$/i,
       use: {
         loader: 'file-loader',
         options: {
           name: 'fonts/[name].[ext]'
         }
       }
     },
  ]
}
```



```javascript
// webpack5ä¸­å¤„ç†å­—ä½“èµ„æºæ–‡ä»¶
module: {
  rules: [
    {
       test: /\.(eot|svg|ttf|woff|woff2)$/i,
       use: {
         loader: 'file-loader',
         options: {
           name: 'fonts/[name].[ext]'
         }
       }
     },
  ]
}
```

